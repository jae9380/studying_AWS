# AWS

https://aws.amazon.com/ko/console/
계정 생성

AWS에서 서버를 생성하는 방법

1.  마우스 클릭으로 서버 생성
2.  명령어를 사용하여 서버 생성
3.  테라폼을 사용하여 서버 생성

위 방법 중 테라폼을 사용하여 서버를 생성 하는 방법을 해보겠다.

---

> ### AWS 회원가입

[AWS 회원가입](https://aws.amazon.com/ko/console/)

위 링크 접속하여 회원가입 진행

- GMail 계정이 하나만 있지만 아이디가 여러개 필요할 경우  
   a@gmail.com 이라는 계정이 있다고 가정을 하면  
   a+aws@gmail.com  
   a+aws1@gmail.com  
   a+aws2@gmail.com 등...  
   이렇게 하나의 Gmail 계정 하나로 여러개의 AWS 계정 생성이 가능하다.

#### IAM

- 사용자와 권한을 관리하는 서비스

예를 들어
AWS를 사용하는 회사에 여러 팀이 존재한다.

- 프론트 팀
  - 서버 1, 2 관리
  - 액세스 권한
- 백엔드 팀
  - 서버 3, 6 관리
  - 액세스 권한
- 인프라 팀
  - 서버 1, 2, 3, 4, 5, 6 관리
  - CRUD 권한
- 회계 팀
  - 1, 2, 3, 4, 5, 6
  - 요금 관련에 접급 권한

등 각 각 필요한 권한에 맞게 그에 맞는 다양한 권한이 존재한다.

root 계정을 모두 같이 공유를 해서 사용한다면 다양한 문제가 발생될 가능성이 있다.  
그래서 root 계정을 통해서 다양한 하위 계정을 만들어 각 계정에 필요한 권한을 설정하여 사용

AWS 사용 주의사항
비용/결제 , IAM 설정은 글로벌 서비스이다.  
위 서비스를 제외 한 모든 서비스는 지역 서비스 이기 때문에 추가적인 요금 발생을 하지 않기위해 주의!

root 계정에서 파생된 계정에 로그인을 하기위해서는 어떤 계정에서 생성한 계정인지 확인을 하기 위해서 구분코드가 생성되어 로그인 시 추가적인 입력이 필요하다.  
개인적으로 구분코드를 사용하여 로그인을 하는 방법 보다는 해당 계정에 별칭을 생성 후 사용 하는 방법이 편하다고 생각하기 때문에 별칭을 생성했다.

- 리전 `Region`  
  인프라를 지리적으로 나누어 배포하는 것을 의미한다.  
  즉, 쉽게 말을하면 나라별 단위?

      `IAM`은 글로벌 서비스이기 때문에 특정 리전에 귀속하지 않는다.
      하지만 `IAM`을 제외한 대부분의 서비스는 특정 리전에 귀속이 된다.

- 가용 영역 `Availability Zone`  
  하나의 리전에는 최소 2개의 데이터 센터가 있고 리전 내 각각의 가용 영역은 고속 네트워크로 연결되어 있다.  
  해당 리전 내 존재하는 가용 영역은 서로 물리적으로 격리되어 있다.

- VPC `Virtual Private Cloud`  
  AWS에서 무억을 만들려고 한다면 무조건 하나의 VPC가 있어야 가능하다.
  VPC는 가용 영역에 귀속되는 것이 아닌 리전에 귀속이 된다.

      * 10.0.0.0/ 16
           10.0.0.0/ 255.255.0.0 이거랑 같은 말이다.
          즉, 네트워크에서 관리가능한 IP의 개수 : 255*255 개
          10.0.0.0/ 11111111.11111111.00000000.00000000 (1은 영역은 건들 수 없는 영역, 0부터 수정이 가능한 영역)
          10.0.0.0 ~ 10.0.0.255, 10.0.1.0 ~10.0.255.255 까지의 IP를 사용 할 수 있다.

      * 10.0.0.0/ 24
          10.0.0.0/ 255.255.255.0
          네트워크에서 관리하는 IP 개수 : 255개
          10.0.0.0/ 11111111.11111111.11111111.00000000
          10.0.0.0/ 24 -> 작은 네트워크

      * 서브넷
      IP 주소의 범위를 뜻 한다.
      간단히 설명을 한다면 VPC에서 IP주소를 파티션으로 나눠서 사용한다?

      * EX
          10.0.0.0/ 16 VPC를 만들고
          서브넷 설정으로 10.0.0.0/ 24, 10.0.1.0/ 24 이렇게 한다면

          VPC는 총 65,536개의 IP주소를 갖고있고
          서브넷은 10.0.0.0/24, 10.0.1.0/24 각 256개의 IP를 사용한다.

vpc는 전체 네트워크를 집이라고 생각하면 서브넷은 방이라고 이해를 하면 된다.

> ### AWS CLI

- AWS CLI 설치

  - 윈도우 사용자  
    [AWS CLI 설치](ttps://docs.aws.amazon.com/ko_kr/cli/latest/userguide/getting-started-install.html)

  - MAC 사용자  
    ` Command line installer - All users`

- 설치 확인

설치 완료 후 콘솔에서 로그인을 하고 싶은 경우 해당 계정의 엑세스 키를 생성을 해야한다

보안 자격 증명 -> 액세스 키 생성

액세스 키 노출 시 심각한 문제가 발생되니 주의

- 로그인

- AWS 엑세스키가 등록되어 있는지 확인

  ```bash
  aws configure list
  ```

- AWS 액세스 키 등록 (로그인)

  ```bash
  aws configure
  ```

  `ap-northeast-2` 은 AWS 서울 의미한다.

  ```bash
  AWS Access Key ID [None]: 액세스 키
  AWS Secret Access Key [None]: 액세스 비밀 키
  Default region name [None]: ap-northeast-2
  Default output format [None]:
  ```

  위 과정을 수행 후

  ```bash
  aws s3 ls
  ```

  입력 후 아무 결과가 안나오면 성공!

- 액세스 키 삭제하는 방법

  `콘솔 접속 -> 해당 유저 선택 -> 보안자격증명 -> 액세스 키 -> 비활성화 -> 삭제`

- AWS CLI에 입력된 액세스 삭제하는 방법

  - 위도우
    - 터미널
    ```bash
    rmdir /s /q "%USERPROFILE%/.aws"
    ```
    - 파워 쉘
    ```bash
    rm -force -recurse $HOME\.aws
    ```
  - Mac
    ```bash
    rm -rf ~/.aws
    ```

- #### 테라폼 CLI 설치
  [테라폼 CLI 설치](https://developer.hashicorp.com/terraform/install?product_intent=terraform)

설치 후 환경변수 등록

설치 확인을 위해 `cmd`를 열어서

```bash
terraform
```

입력을 하면 확인이 가능하다
